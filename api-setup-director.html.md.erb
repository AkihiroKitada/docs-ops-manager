---
title: Configuring the BOSH Director with the Ops Manager API
owner: Ops Manager
---

## <a id="overview"></a>Overview

This topic describes how to configure the BOSH Director using the Ops Manager API. Advanced PCF operators and administrators can do a complete end-to-end setup of Ops Manager using the API. This procedure is not intended for beginner users of Ops Manager, PCF, or API-based procedures. 

For information about setting up Ops Manager with the UI, see [Using Ops Manager](https://docs.pivotal.io/pivotalcf/2-5/customizing/ops-man.html).

## <a id="prereqs"></a>Prerequisites

Before you configure the BOSH Director with the Ops Manager API, you must have the following components downloaded or accessible on your local host:

* A current version of Ops Manager downloaded from [Pivotal Network](https://network.pivotal.io).
* Access to the Ops Manager API. For more information about the Ops Manager API, see [Using the Ops Manager API](./ops-man-api.html).
* An external SAML or LDAP client.
* An IaaS provider configured for use with Ops Manager. For more information about configuring an IaaS, see [Planning Your PCF Deployment](./plan.html).

## <a id="api-setup"> Setting Up the BOSH Director

To configure the BOSH Director with the Ops Manager API, do the following:

<ol>
<li>Access the Ops Manager API by following the procedure in <a href="./ops-man-api.html">Using the Ops Manager API</a>.</li>
<li>Enter the following HTTP request to perform intial setup: <code>POST /api/v0/setup</code>. Include metadata in your request to specify configuration details for your deployment. For example, specify the deployment's decryption passphrase, EULA status, and proxy information, if applicable. An example request follows:
<p class="terminal">
	curl "https://YOUR-OPS-MANAGER-URL.com/api/v0/setup" \
    -X POST \
    -H "Content-Type: application/json" \
    -d '{ "setup": {
    "decryption_passphrase": "EXAMPLE-PASSPHRASE",
    "decryption_passphrase_confirmation":"EXAMPLE-PASSPHRASE",
    "eula_accepted": "true",
    "identity_provider": "internal",
    "admin_user_name": "EXAMPLE-ADMIN-USERNAME",
    "admin_password": "EXAMPLE-ADMIN-PASSWORD",
    "admin_password_confirmation": "EXAMPLE-ADMIN-PASSWORD",
    "http_proxy": "http://PROXY-NAME.YOUR-WEBSITE.com",
    "https_proxy": "https://PROXY-NAME.YOUR-WEBSITE.com",
    "no_proxy": "127.0.0.1"
  } }'
</p>
 	<p class="note"><strong>Note</strong>: You do not need to specify UAA or other authentication details on a first-time deploy. If you do, the deployment will fail.</p>
</li>
<li>A <code>200 OK</code> response returns.</li>
<li>When the <code>200 OK</code> response returns, a UAA client is created and launched with the metadata you specified applied. Ops Manager users can authenticate with UAAC, and if they have a pre-created client they can target UAAC with the client name and password. For more information on pre-created clients, see <a href="./opsman-users.html">Creating and Managing Ops Manager User and Client Accounts</a>.
<li>Enter the following HTTP request to perform configure your IaaS and BOSH Director: <code>PUT api/v0/staged/director/properties</code>. 

  All the commands are IaaS-agnostic except the IaaS configuration key. Missing required fields should cause an error.

Create AZs -- OPTIONAL: In Azure, they won’t need this endpoint at all, because we set up AZs for them automatically.
  POST api/v0/staged/director/availability_zones

Create networking rules for the foundation -- Create networks, determine whether you’re enabling ICMP checks or not 
  PUT api/v0/staged/director/networks

AZs and Network assignment -- Assign a singleton availability zone and network where your BOSH Director is going to live
  PUT api/v0/staged/director/network_and_az 

Updating the Bosh Director’s Resource config
  Grab the director’s guid - GET api/v0/staged/products
  See a list of all jobs on the director - GET api/v0/staged/products/:bosh_guid/jobs
  Updating a job’s resource config
		PUT api/v0/staged/products/:bosh_guid/jobs/:job_guid/resource_config

Optional: They could stop and deploy here!
  POST /api/v0/installations 
  This is the last step to Apply Changes/deploy any config change
</ol>