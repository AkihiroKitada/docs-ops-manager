---
title: Overriding Duration for Certificates
owner: Ops Manager
---

This topic describes how to set values to override the duration for certificate authority (CA) and leaf certificates managed by <%= vars.ops_manager %> and CredHub.

## <a id='overview'></a> Overview

By default, certificates generated by <%= vars.ops_manager %> and CredHub will be generated using the duration set by the Tile and certificate authors. This duration can vary from certificate to certificate. In <%= vars.ops_manager %> v2.10.17 and later, you can set values to override the duration for CA and leaf certificates, giving you the option to increase the durations for CAs and leaf certificates reducing the frequency of required certificate rotations. 

With this feature enabled, when you configure durations shorter than the current durations set by tile and certificate authors, the certificates will be generated with the current durations. If you configure durations longer than the current durations set by tile and certificate authors, then the certificates will be generated with the longer durations set by you.

For example, <%= vars.app_runtime %> may create a leaf certificate with a duration of 365 days. If you configure the leaf certificate duration to be 730 days, then when <%= vars.app_runtime %> is first deployed or when the certificates are regenerated, the leaf certificates are created using a duration of 730 days instead. A <%= vars.app_runtime %> certificate that is normally created with a duration of 1460 days continues to be created with a duration of 1460 days.

## <a id='configure'></a> Configuring Duration overrides

To enable the duration overrides feature:

1. Click the **BOSH Director** tile.
1. Select **Director Config**.
1. Scroll down to the **Certificate Duration Overrides** section.
1. Select the **On** option.
1. Enter the desired duration for CA certificates in the **CA Certificate Duration** field.
1. Enter the desired duration for leaf certificates in the **Leaf Certificate Duration** field.
1. Click **Save**.

After enabling the duration overrides feature, you must take additional steps to apply the setting to existing certificates, as well as any new certificates generated by CredHub.

###<a id='apply-existing'></a> Applying Duration Overrides on an Existing <%= vars.ops_manager %>

This procedure describes how to apply duration overrides on an already existing <%= vars.ops_manager %>.

1. Apply Changes on the BOSH Director. This ensures that future certificates generated by CredHub will use the new configured durations.
1. To apply duration overrides to leaf certificates, you must do a leaf certificate rotation.
    1. To rotate non-configurable leaf certificates, see [Rotating Non-Configurable Leaf Certificates](rotate-non-configurable-certs.html).
    1. To rotate certificates generated using the "Generate RSA Certificate" button, see [Rotating Configurable Leaf Certificates](rotate-configurable-certs.html)
1. To apply duration overrides to both CA and leaf certificates, you must do a full CA rotation. To rotate CAs and leaf certificates, see [Rotating CAs and Leaf Certificates](rotate-cas-and-leaf-certs.html).
1. By default, the Services TLS CA is excluded by the <%= vars.ops_manager %> certificate rotation API. It is possible to rotate this certificate separately in order to apply the configured duration. To rotate the Services TLS CA, see [Rotate the Services TLS CA and Its Leaf Certificates](advanced-certificate-rotation.html#services-rotation).

###<a id='apply-new'></a> Applying Duration Overrides on a New <%= vars.ops_manager %>

This procedure describes how to apply duration overrides on a new <%= vars.ops_manager %>.

<p class="note warning"><strong>Warning:</strong> If you have done an Apply Changes on the BOSH Director tile, you <strong>must</strong> use the procedure described by <a href="#apply-existing">Applying Duration Overrides on an Existing <%= vars.ops_manager %></a> instead.</p>

1. To apply duration overrides to leaf certificates, no action is required. Leaf certificates will be created using the appropriate duration during the first Apply Changes.
1. To apply duration overrides to CA certificates, you must regenerate the CA certificates. This can be done by following the procedure described by [Rotating CAs and Leaf Certificates](rotate-cas-and-leaf-certs.html) with the following modifications:
    1. You do not need to enable the **Recreate VMs deployed by the BOSH Director** checkbox.
    1. You do not need to run Apply Changes.

## <a id='excluded-certs'></a> Excluded Certificates

The duration overrides setting only applies to certificates that are rotated by the <%= vars.ops_manager %> certificate rotation procedures. The following certificates do not use the duration overrides setting:

* **User-provided certificates:** Products installed using <%= vars.ops_manager %> can contain fields that request operator-provided certificates. These certificates do not have the duration overrides enforced because they are not generated by <%= vars.ops_manager %> or CredHub. These fields also provide a "Generate RSA Certificate" button which can be used to generate a certificate instead of requiring an operator-provided certificate. Certificates generated using the "Generate RSA Certificate" button will have the duration overrides enforced.

* **<%= vars.ops_manager %> SAML Certificate:** The <%= vars.ops_manager %> SAML Certificate is used by UAA when <%= vars.ops_manager %> has been configured to use SAML. This certificate is valid for 730 days, and is not rotated by the same procedure that rotates other certificates. To rotate this certificate, see [How to check and rotate Ops Manager SAML Certificate before it expires](https://community.pivotal.io/s/article/how-to-check-and-rotate-ops-manager-saml-certificate-before-it-expires).

* **<%= vars.ops_manager %> SSL Certificate:** The <%= vars.ops_manager %> SSL Certificate is used to secure communication between the operator's browser and the <%= vars.ops_manager %> application. By default, this is a self-signed certificate created when the <%= vars.ops_manager %> VM is first launched. This certificate is valid for 365 days, and is automatically regenerated when upgrading <%= vars.ops_manager %>.

* **NATS client certificates:** Each BOSH-deployed VM has a unique NATS client certificate used to communicate with the BOSH Director. This certificate is regenerated each time the VM is recreated.

* **Diego identity certificates:** Each app instance deployed within <%= vars.app_runtime %> has a unique identity certificate used to communicate with Diego. The Diego cell rep supplies a new certificate and private key pair to the app instance before the end of the validity period. See [Using Instance Identity Credentials](https://docs.pivotal.io/application-service/<%= vars.current_major_version.sub('.','-') %>/devguide/deploy-apps/instance-identity.html) for more details.

* All other certificates that have a default duration longer than the duration configured by the operator.

<p class="note"><strong>Note:</strong> We encourage that you DO NOT change your currently scheduled certificate rotations to use this feature, you can enable it beforehand and start using it when the next scheduled rotation takes place.</p>
